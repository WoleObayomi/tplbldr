<!doctype html>
<html>
    <head>
        <meta charset="utf8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    </head>
    <body>
        <script src="/js/helpers.js"></script>
        <script src="/js/tplbuilder.js"></script>
        <script>
            var getRequest = helpers.makeRequest("GET");
            getRequest("https://jsonplaceholder.typicode.com/users").then(function(data) {
               
                var personTpl = {
                    wrapper:{
                        classList:[],
                        el:'div',
                        listeners:[{
                            ev:"click",
                            target:".with-attr",
                            handler: function (e) {
                                var targetElement = e.target;
                                console.log(targetElement.innerHTML);
                            }
                        }]
                    },
                    tpl:
                    "Username: <div class='with-attr' data-attr='username'></div>"+
                    "Email: <div class='with-attr' data-attr='email'></div>"+
                    "Website: <div class='with-attr' data-attr='website'></div>"+
                    "Company: <div class='with-attr' data-attr='company.name'></div>"+
                    "City: <div class='with-attr' data-attr='residence'></div>"+
                    "<br>"
                };

                TplBuilder.getBuiltTemplate(personTpl, data, "body", {
                    toBuild: {
                        username: ["name"],
                        residence: ["address.suite", "address.city"]
                    },
                    toFormat: {
                        username: ["lower", "join"],
                        "email": ["lower"],
                        "company.name": ["upper"],
                        "address.city": ["capitalize"]
                    }
                }, true)
                
            }).catch(function(e) {
                console.log(e);
            });


        </script>
    </body>
</html>